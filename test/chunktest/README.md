# è·¨è¿›ç¨‹ Chunk æµ‹è¯•

## ğŸ“‹ æ¦‚è¿°

æœ¬æµ‹è¯•éªŒè¯ ZeroCP æ¡†æ¶çš„è·¨è¿›ç¨‹é›¶æ‹·è´å†…å­˜è®¿é—®èƒ½åŠ›ï¼Œé‡ç‚¹æµ‹è¯•ï¼š

1. **å…±äº«å†…å­˜æœºåˆ¶**ï¼šå¤šè¿›ç¨‹å…±äº«åŒä¸€å—å†…å­˜æ± 
2. **RelativePointer**ï¼šè·¨è¿›ç¨‹åœ°å€è½¬æ¢çš„æ­£ç¡®æ€§
3. **Chunk ç®¡ç†**ï¼šChunkManager åœ¨ä¸åŒè¿›ç¨‹ä¸­çš„è®¿é—®
4. **æ•°æ®å®Œæ•´æ€§**ï¼šè·¨è¿›ç¨‹æ•°æ®è¯»å†™çš„å‡†ç¡®æ€§

## ğŸ¯ æµ‹è¯•ç›®æ ‡

### æ ¸å¿ƒéªŒè¯ç‚¹

- âœ… å†™è¿›ç¨‹åˆ›å»ºå…±äº«å†…å­˜æ± 
- âœ… è¯»è¿›ç¨‹é™„åŠ åˆ°å·²å­˜åœ¨çš„å…±äº«å†…å­˜
- âœ… å†™è¿›ç¨‹å‘æ±  1/2/3 å†™å…¥æ•°æ®
- âœ… è¯»è¿›ç¨‹ä»æ±  1/2/3 è¯»å–å¹¶éªŒè¯æ•°æ®
- âœ… RelativePointer åœ¨ä¸åŒè¿›ç¨‹åœ°å€ç©ºé—´ä¸­æ­£ç¡®è§£æ
- âœ… ChunkHeader å’Œç”¨æˆ·æ•°æ®åŒºçš„è·¨è¿›ç¨‹è®¿é—®
- âœ… æ•°æ®å®Œæ•´æ€§ï¼ˆé­”æ•°ã€æ ¡éªŒå’Œã€å†…å®¹ï¼‰

## ğŸ—ï¸ æ¶æ„è®¾è®¡

### å†…å­˜å¸ƒå±€

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    å…±äº«å†…å­˜æ±                             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  ç®¡ç†åŒº (Management Area)                               â”‚
â”‚  â”œâ”€ MemPoolManager                                      â”‚
â”‚  â”œâ”€ ChunkManagerPool (æ‰€æœ‰ ChunkManager å¯¹è±¡)          â”‚
â”‚  â””â”€ å…¶ä»–ç®¡ç†ç»“æ„                                        â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  æ•°æ®åŒº (Data Area)                                     â”‚
â”‚  â”œâ”€ æ± 0: 128B Ã— 100                                    â”‚
â”‚  â”œâ”€ æ± 1: 1KB Ã— 50   â† æµ‹è¯•å†™å…¥/è¯»å–                    â”‚
â”‚  â”œâ”€ æ± 2: 4KB Ã— 20   â† æµ‹è¯•å†™å…¥/è¯»å–                    â”‚
â”‚  â””â”€ æ± 3: 16KB Ã— 10  â† æµ‹è¯•å†™å…¥/è¯»å–                    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### è¿›ç¨‹äº¤äº’æµç¨‹

```
å†™è¿›ç¨‹ (Writer)                     è¯»è¿›ç¨‹ (Reader)
     â”‚                                   â”‚
     â”œâ”€ 1. åˆ›å»ºå…±äº«å†…å­˜æ±                 â”‚
     â”‚   â””â”€ åˆå§‹åŒ–æ±  0/1/2/3             â”‚
     â”‚                                   â”‚
     â”œâ”€ 2. å‘æ± 1å†™å…¥æ•°æ®                 â”‚
     â”‚   â””â”€ TestData {magic, poolId=1}   â”‚
     â”‚                                   â”‚
     â”œâ”€ 3. å‘æ± 2å†™å…¥æ•°æ®                 â”‚
     â”‚   â””â”€ TestData {magic, poolId=2}   â”‚
     â”‚                                   â”‚
     â”œâ”€ 4. å‘æ± 3å†™å…¥æ•°æ®                 â”‚
     â”‚   â””â”€ TestData {magic, poolId=3}   â”‚
     â”‚                                   â”‚
     â”œâ”€ 5. ä¿æŒè¿è¡Œ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€> â”œâ”€ 1. é™„åŠ åˆ°å…±äº«å†…å­˜
     â”‚                                   â”‚
     â”‚                                   â”œâ”€ 2. éå† ChunkManagerPool
     â”‚                                   â”‚   â””â”€ æ‰¾åˆ°æ± 1çš„ Chunk
     â”‚                                   â”‚
     â”‚                                   â”œâ”€ 3. éªŒè¯æ± 1æ•°æ®
     â”‚                                   â”‚   â””â”€ æ£€æŸ¥ magic, poolId, checksum
     â”‚                                   â”‚
     â”‚                                   â”œâ”€ 4. éªŒè¯æ± 2æ•°æ®
     â”‚                                   â”‚
     â”‚                                   â”œâ”€ 5. éªŒè¯æ± 3æ•°æ®
     â”‚                                   â”‚
     â”‚ <â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ â”œâ”€ 6. å®ŒæˆéªŒè¯
     â”‚                                   â”‚
     â”œâ”€ 6. æ”¶åˆ°ä¿¡å·é€€å‡º                  â”œâ”€ 7. æ¸…ç†å¹¶é€€å‡º
     â”‚                                   â”‚
     â””â”€ 7. æ¸…ç†å…±äº«å†…å­˜                  â””â”€
```

## ğŸ”§ å®ç°ç»†èŠ‚

### å†™è¿›ç¨‹ (test_chunk_writer.cpp)

**ä¸»è¦åŠŸèƒ½**ï¼š

1. åˆ›å»ºå…±äº«å†…å­˜æ± ï¼ˆ4ä¸ªæ± ï¼š128B, 1KB, 4KB, 16KBï¼‰
2. å‘æ± 1/2/3å„åˆ†é…ä¸€ä¸ª Chunk
3. å†™å…¥æµ‹è¯•æ•°æ®ï¼ˆåŒ…å«é­”æ•°ã€æ± IDã€åºåˆ—å·ã€æ ¡éªŒå’Œã€æ¶ˆæ¯ï¼‰
4. ä¿æŒè¿è¡Œï¼Œç­‰å¾…è¯»è¿›ç¨‹éªŒè¯

**å…³é”®ä»£ç **ï¼š

```cpp
// åˆ†é… Chunk
auto chunkResult = manager->getChunk(dataSize, poolId);
ChunkManager* chunk = chunkResult.value();

// è·å–ç”¨æˆ·æ•°æ®åŒº
ChunkHeader* header = chunk->m_chunkHeader.get();
void* userData = header->getUserData();

// å†™å…¥æ•°æ®
TestData* data = static_cast<TestData*>(userData);
data->magic = 0xDEADBEEF12345678ULL;
data->poolId = poolId;
data->sequence = sequence;
data->checksum = data->calculateChecksum();
```

### è¯»è¿›ç¨‹ (test_chunk_reader.cpp)

**ä¸»è¦åŠŸèƒ½**ï¼š

1. é™„åŠ åˆ°å·²å­˜åœ¨çš„å…±äº«å†…å­˜æ± 
2. éå† ChunkManagerPoolï¼Œæ‰¾åˆ°å±äºæ± 1/2/3çš„ Chunk
3. é€šè¿‡ RelativePointer è®¿é—® ChunkHeader å’Œç”¨æˆ·æ•°æ®
4. éªŒè¯æ•°æ®å®Œæ•´æ€§

**å…³é”®ä»£ç **ï¼š

```cpp
// é™„åŠ åˆ°å…±äº«å†…å­˜
MemPoolManager::attachToSharedInstance();

// éå† ChunkManagerPool æ‰¾åˆ°ç›®æ ‡æ± çš„ Chunk
for (uint32_t i = 0; i < totalChunks; ++i) {
    ChunkManager* chunkMgr = reinterpret_cast<ChunkManager*>(
        static_cast<char*>(managementBase) + 
        pool.getDataOffset() + 
        i * sizeof(ChunkManager)
    );
    
    if (chunkMgr->m_poolId == targetPoolId) {
        // æ‰¾åˆ°ç›®æ ‡ Chunk
        ChunkHeader* header = chunkMgr->m_chunkHeader.get();
        void* userData = header->getUserData();
        // éªŒè¯æ•°æ®...
    }
}
```

### æµ‹è¯•æ•°æ®ç»“æ„

```cpp
struct TestData {
    uint64_t magic;        // 0xDEADBEEF12345678
    uint32_t poolId;       // 1/2/3
    uint32_t sequence;     // 101/202/303
    uint32_t checksum;     // è®¡ç®—å¾—å‡º
    char message[240];     // "Test data from Pool X..."
    
    uint32_t calculateChecksum() const;
};
```

## ğŸš€ å¿«é€Ÿå¼€å§‹

### æ–¹æ³•1ï¼šè‡ªåŠ¨åŒ–æµ‹è¯•ï¼ˆæ¨èï¼‰

```bash
# ä¸€é”®è¿è¡Œå®Œæ•´æµ‹è¯•
./run_chunk_test.sh
```

è„šæœ¬ä¼šè‡ªåŠ¨ï¼š
1. æ£€æŸ¥å¹¶ç¼–è¯‘æµ‹è¯•ç¨‹åº
2. æ¸…ç†æ—§çš„å…±äº«å†…å­˜
3. å¯åŠ¨å†™è¿›ç¨‹ï¼ˆåå°ï¼‰
4. ç­‰å¾…3ç§’åˆå§‹åŒ–
5. å¯åŠ¨è¯»è¿›ç¨‹éªŒè¯
6. æ˜¾ç¤ºæµ‹è¯•ç»“æœ
7. æ¸…ç†èµ„æº

### æ–¹æ³•2ï¼šæ‰‹åŠ¨æµ‹è¯•

```bash
# ç»ˆç«¯1ï¼šå¯åŠ¨å†™è¿›ç¨‹
./manual_test.sh writer

# ç»ˆç«¯2ï¼šå¯åŠ¨è¯»è¿›ç¨‹
./manual_test.sh reader

# æ¸…ç†å…±äº«å†…å­˜
./manual_test.sh clean
```

### æ–¹æ³•3ï¼šç›´æ¥è¿è¡Œ

```bash
# ç¼–è¯‘
cd build
cmake ..
make -j4

# ç»ˆç«¯1ï¼šå†™è¿›ç¨‹
./bin/test_chunk_writer

# ç»ˆç«¯2ï¼šè¯»è¿›ç¨‹ï¼ˆæŒ‰æç¤ºæŒ‰ Enterï¼‰
./bin/test_chunk_reader
```

## ğŸ“Š é¢„æœŸè¾“å‡º

### å†™è¿›ç¨‹è¾“å‡º

```
========================================
  è·¨è¿›ç¨‹ Chunk æµ‹è¯• - å†™è¿›ç¨‹
========================================

[1] åˆ›å»ºå…±äº«å†…å­˜æ± ...
  âœ“ å…±äº«å†…å­˜æ± åˆ›å»ºæˆåŠŸ
  âœ“ MemPoolManager å®ä¾‹è·å–æˆåŠŸ

[2] å†™è¿›ç¨‹åˆå§‹åŒ–åçš„å†…å­˜æ± çŠ¶æ€:
Pool 0: 128 B Ã— 100 chunks (å·²ç”¨: 0, ç©ºé—²: 100)
Pool 1: 1024 B Ã— 50 chunks (å·²ç”¨: 0, ç©ºé—²: 50)
Pool 2: 4096 B Ã— 20 chunks (å·²ç”¨: 0, ç©ºé—²: 20)
Pool 3: 16384 B Ã— 10 chunks (å·²ç”¨: 0, ç©ºé—²: 10)

[3] å‘å†…å­˜æ±  1/2/3 å†™å…¥æµ‹è¯•æ•°æ®...

========== å‘å†…å­˜æ±  1 å†™å…¥æ•°æ® ==========
  âœ“ Chunk åˆ†é…æˆåŠŸ
    ChunkManager åœ°å€: 0x7f1234567890
    Chunk ç´¢å¼•: 0
    ChunkManager ç´¢å¼•: 0
    æ‰€å±æ± ID: 1
  âœ“ ChunkHeader è·å–æˆåŠŸ
  âœ“ ç”¨æˆ·æ•°æ®åŒºè·å–æˆåŠŸ

å†™å…¥çš„æ•°æ®:
  - Magic: 0xdeadbeef12345678
  - PoolId: 1
  - Sequence: 101
  - Checksum: 0x12345678
  - Message: Test data from Pool 1, Sequence 101

  âœ“âœ“âœ“ æ±  1 æ•°æ®å†™å…¥æˆåŠŸï¼âœ“âœ“âœ“

[ç±»ä¼¼è¾“å‡ºæ± 2å’Œæ± 3...]

========================================
  âœ“âœ“âœ“ æ•°æ®å†™å…¥å®Œæˆï¼âœ“âœ“âœ“
========================================

å†™è¿›ç¨‹å°†ä¿æŒè¿è¡Œï¼Œç­‰å¾…è¯»è¿›ç¨‹éªŒè¯æ•°æ®...
```

### è¯»è¿›ç¨‹è¾“å‡º

```
========================================
  è·¨è¿›ç¨‹ Chunk æµ‹è¯• - è¯»è¿›ç¨‹
========================================

è¯·ç¡®ä¿å†™è¿›ç¨‹å·²ç»å¯åŠ¨å¹¶å®Œæˆåˆå§‹åŒ–
æŒ‰ Enter ç»§ç»­...

[1] é™„åŠ åˆ°å·²å­˜åœ¨çš„å…±äº«å†…å­˜...
  âœ“ æˆåŠŸé™„åŠ åˆ°å…±äº«å†…å­˜
  âœ“ MemPoolManager å®ä¾‹è·å–æˆåŠŸ

[2] è¯»è¿›ç¨‹è§†è§’çš„å†…å­˜æ± çŠ¶æ€:
Pool 0: 128 B Ã— 100 chunks (å·²ç”¨: 0, ç©ºé—²: 100)
Pool 1: 1024 B Ã— 50 chunks (å·²ç”¨: 1, ç©ºé—²: 49)
Pool 2: 4096 B Ã— 20 chunks (å·²ç”¨: 1, ç©ºé—²: 19)
Pool 3: 16384 B Ã— 10 chunks (å·²ç”¨: 1, ç©ºé—²: 9)

[3] ä»å†…å­˜æ±  1/2/3 è¯»å–å¹¶éªŒè¯æ•°æ®...

========== ä»å†…å­˜æ±  1 è¯»å–æ•°æ® ==========
  âœ“ ç®¡ç†åŒºåŸºåœ°å€: 0x7f9876543210
  æœç´¢æ±  1 çš„ Chunkï¼ˆæ€»å…± 180 ä¸ª ChunkManagerï¼‰...
  âœ“ æ‰¾åˆ°æ±  1 çš„ Chunkï¼ˆChunkManager ç´¢å¼•: 0ï¼‰

ChunkManager ä¿¡æ¯:
  - åœ°å€: 0x7f9876543210
  - Chunk ç´¢å¼•: 0
  - ChunkManager ç´¢å¼•: 0
  - æ± ID: 1
  - å¼•ç”¨è®¡æ•°: 1
  âœ“ ChunkHeader åœ°å€: 0x7f9876544000
  âœ“ ç”¨æˆ·æ•°æ®åŒºåœ°å€: 0x7f9876544020

è¯»å–çš„æ•°æ®:
  - Magic: 0xdeadbeef12345678 âœ“
  - PoolId: 1 âœ“
  - Sequence: 101 âœ“
  - Checksum: 0x12345678 âœ“
  - Message: Test data from Pool 1, Sequence 101

  âœ“âœ“âœ“ æ±  1 æ•°æ®éªŒè¯æˆåŠŸï¼âœ“âœ“âœ“

[ç±»ä¼¼è¾“å‡ºæ± 2å’Œæ± 3...]

========================================
  æµ‹è¯•ç»“æœæ€»ç»“
========================================
âœ“âœ“âœ“ æ‰€æœ‰æµ‹è¯•é€šè¿‡ï¼âœ“âœ“âœ“

æˆåŠŸéªŒè¯ï¼š
  1. è·¨è¿›ç¨‹å…±äº«å†…å­˜é™„åŠ æˆåŠŸ
  2. ä»æ± 1/2/3è¯»å–æ•°æ®æˆåŠŸ
  3. RelativePointer åœ°å€è½¬æ¢æ­£ç¡®
  4. æ•°æ®å®Œæ•´æ€§éªŒè¯é€šè¿‡
  5. è·¨è¿›ç¨‹é›¶æ‹·è´è®¿é—®æˆåŠŸ
========================================
```

## ğŸ” éªŒè¯è¦ç‚¹

### 1. å…±äº«å†…å­˜é™„åŠ 

- âœ… è¯»è¿›ç¨‹èƒ½æˆåŠŸé™„åŠ åˆ°å†™è¿›ç¨‹åˆ›å»ºçš„å…±äº«å†…å­˜
- âœ… ä¸¤ä¸ªè¿›ç¨‹çœ‹åˆ°ç›¸åŒçš„å†…å­˜æ± çŠ¶æ€

### 2. RelativePointer è·¨è¿›ç¨‹è§£æ

- âœ… `ChunkManager::m_chunkHeader` (RelativePointer) åœ¨è¯»è¿›ç¨‹ä¸­æ­£ç¡®è§£æ
- âœ… `ChunkHeader::getUserData()` è¿”å›æ­£ç¡®çš„ç”¨æˆ·æ•°æ®åŒºåœ°å€
- âœ… ä¸åŒè¿›ç¨‹çš„è™šæ‹Ÿåœ°å€å¯èƒ½ä¸åŒï¼Œä½†ç›¸å¯¹åç§»ä¸€è‡´

### 3. æ•°æ®å®Œæ•´æ€§

- âœ… é­”æ•° (0xDEADBEEF12345678) æ­£ç¡®
- âœ… æ± ID (1/2/3) åŒ¹é…
- âœ… åºåˆ—å· (101/202/303) æ­£ç¡®
- âœ… æ ¡éªŒå’ŒéªŒè¯é€šè¿‡
- âœ… æ¶ˆæ¯å†…å®¹å®Œæ•´

### 4. Chunk ç®¡ç†

- âœ… å†™è¿›ç¨‹åˆ†é…çš„ Chunk åœ¨è¯»è¿›ç¨‹ä¸­å¯è§
- âœ… ChunkManager ç´¢å¼•æœºåˆ¶å·¥ä½œæ­£å¸¸
- âœ… å¼•ç”¨è®¡æ•°åœ¨ä¸¤ä¸ªè¿›ç¨‹ä¸­ä¸€è‡´

## ğŸ› æ•…éšœæ’æŸ¥

### é—®é¢˜1ï¼šè¯»è¿›ç¨‹é™„åŠ å¤±è´¥

**ç—‡çŠ¶**ï¼š
```
é™„åŠ åˆ°å…±äº«å†…å­˜å¤±è´¥
```

**åŸå› **ï¼š
- å†™è¿›ç¨‹æœªå¯åŠ¨æˆ–å·²é€€å‡º
- å…±äº«å†…å­˜åç§°ä¸åŒ¹é…

**è§£å†³**ï¼š
```bash
# æ£€æŸ¥å†™è¿›ç¨‹æ˜¯å¦è¿è¡Œ
ps aux | grep test_chunk_writer

# æ£€æŸ¥å…±äº«å†…å­˜
ls -lh /dev/shm/zerocp_*

# æ¸…ç†å¹¶é‡æ–°è¿è¡Œ
./manual_test.sh clean
```

### é—®é¢˜2ï¼šRelativePointer è§£æå¤±è´¥

**ç—‡çŠ¶**ï¼š
```
âœ— æ— æ³•è·å– ChunkHeaderï¼ˆRelativePointer è§£æå¤±è´¥ï¼‰
```

**åŸå› **ï¼š
- åŸºåœ°å€æœªæ­£ç¡®è®¾ç½®
- ç›¸å¯¹åç§»è®¡ç®—é”™è¯¯

**è°ƒè¯•**ï¼š
```cpp
// åœ¨è¯»è¿›ç¨‹ä¸­æ·»åŠ è°ƒè¯•è¾“å‡º
std::cout << "Management base: " << MemPoolManager::s_managementBaseAddress << std::endl;
std::cout << "Data base: " << MemPoolManager::s_dataBaseAddress << std::endl;
std::cout << "RelativePointer offset: " << chunk->m_chunkHeader.getOffset() << std::endl;
```

### é—®é¢˜3ï¼šæ•°æ®éªŒè¯å¤±è´¥

**ç—‡çŠ¶**ï¼š
```
âœ— Magic: 0x0 (æœŸæœ›: 0xDEADBEEF12345678)
```

**åŸå› **ï¼š
- å†™è¿›ç¨‹æœªå®Œæˆåˆå§‹åŒ–
- è¯»è¿›ç¨‹è®¿é—®äº†é”™è¯¯çš„ Chunk
- å†…å­˜æœªæ­£ç¡®å…±äº«

**è§£å†³**ï¼š
```bash
# å¢åŠ ç­‰å¾…æ—¶é—´
# åœ¨ run_chunk_test.sh ä¸­ä¿®æ”¹ï¼š
sleep 5  # åŸæ¥æ˜¯ 3 ç§’
```

### é—®é¢˜4ï¼šæ‰¾ä¸åˆ°ç›®æ ‡æ± çš„ Chunk

**ç—‡çŠ¶**ï¼š
```
âœ— æœªæ‰¾åˆ°æ±  1 çš„æœ‰æ•ˆ Chunk
```

**åŸå› **ï¼š
- å†™è¿›ç¨‹æœªå‘è¯¥æ± å†™å…¥æ•°æ®
- ChunkManager éå†é€»è¾‘é”™è¯¯

**è°ƒè¯•**ï¼š
```cpp
// æ‰“å°æ‰€æœ‰ ChunkManager çš„çŠ¶æ€
for (uint32_t i = 0; i < totalChunks; ++i) {
    ChunkManager* cm = ...;
    std::cout << "ChunkManager[" << i << "]: "
              << "poolId=" << cm->m_poolId
              << ", refCount=" << cm->m_refCount.load()
              << std::endl;
}
```

## ğŸ“ æ–‡ä»¶è¯´æ˜

| æ–‡ä»¶ | è¯´æ˜ |
|------|------|
| `test_chunk_writer.cpp` | å†™è¿›ç¨‹ï¼šåˆ›å»ºå…±äº«å†…å­˜å¹¶å†™å…¥æ•°æ® |
| `test_chunk_reader.cpp` | è¯»è¿›ç¨‹ï¼šé™„åŠ å…±äº«å†…å­˜å¹¶éªŒè¯æ•°æ® |
| `run_chunk_test.sh` | è‡ªåŠ¨åŒ–æµ‹è¯•è„šæœ¬ |
| `manual_test.sh` | æ‰‹åŠ¨æµ‹è¯•è¾…åŠ©è„šæœ¬ |
| `CMakeLists.txt` | æ„å»ºé…ç½® |
| `README.md` | æœ¬æ–‡æ¡£ |
| `QUICKSTART.md` | å¿«é€Ÿå…¥é—¨æŒ‡å— |

## ğŸ“ å­¦ä¹ è¦ç‚¹

### 1. å…±äº«å†…å­˜çš„æ­£ç¡®ä½¿ç”¨

- åˆ›å»ºè€…ä½¿ç”¨ `createSharedInstance()`
- é™„åŠ è€…ä½¿ç”¨ `attachToSharedInstance()`
- æ¸…ç†æ—¶åªæœ‰åˆ›å»ºè€…è°ƒç”¨ `destroySharedInstance()`

### 2. RelativePointer çš„ä¼˜åŠ¿

- å­˜å‚¨ç›¸å¯¹åç§»è€Œéç»å¯¹åœ°å€
- åœ¨ä¸åŒè¿›ç¨‹çš„ä¸åŒè™šæ‹Ÿåœ°å€ç©ºé—´ä¸­éƒ½èƒ½æ­£ç¡®è§£æ
- æ˜¯å®ç°è·¨è¿›ç¨‹é›¶æ‹·è´çš„å…³é”®

### 3. ChunkManager ç´¢å¼•æœºåˆ¶

- æ¯ä¸ª ChunkManager æœ‰å”¯ä¸€çš„ç´¢å¼•
- ç´¢å¼•å¯ä»¥åœ¨è¿›ç¨‹é—´ä¼ é€’
- é€šè¿‡ç´¢å¼•å¯ä»¥é‡å»º ChunkManager æŒ‡é’ˆï¼ˆå½“å‰æµ‹è¯•ä¸­é€šè¿‡éå†å®ç°ï¼‰

### 4. å†…å­˜æ± çš„å±‚æ¬¡ç»“æ„

```
MemPoolManager
  â”œâ”€ ChunkManagerPool (ç®¡ç†åŒº)
  â”‚   â””â”€ ChunkManager[] (æ‰€æœ‰æ± çš„ ChunkManager)
  â””â”€ DataPools (æ•°æ®åŒº)
      â”œâ”€ Pool 0
      â”œâ”€ Pool 1
      â”œâ”€ Pool 2
      â””â”€ Pool 3
```

## ğŸ”„ åç»­è®¡åˆ’

- [ ] å®ç° ChunkManager æŒ‡é’ˆçš„è·¨è¿›ç¨‹ä¼ è¾“æœºåˆ¶
- [ ] æ”¯æŒé€šè¿‡æ¶ˆæ¯é˜Ÿåˆ—ä¼ é€’ ChunkManager ç´¢å¼•
- [ ] æ·»åŠ æ€§èƒ½æµ‹è¯•ï¼ˆå»¶è¿Ÿã€ååé‡ï¼‰
- [ ] æ”¯æŒå¤šè¯»è¿›ç¨‹å¹¶å‘è®¿é—®
- [ ] æ·»åŠ å‹åŠ›æµ‹è¯•

## ğŸ“š ç›¸å…³æ–‡æ¡£

- `QUICKSTART.md` - å¿«é€Ÿå…¥é—¨
- ä¸»é¡¹ç›® `docs/` - æ¶æ„è®¾è®¡æ–‡æ¡£
- `zerocp_daemon/memory/` - å†…å­˜ç®¡ç†å®ç°

## âœ… æµ‹è¯•æ£€æŸ¥æ¸…å•

è¿è¡Œæµ‹è¯•å‰ç¡®è®¤ï¼š

- [ ] ä¸»é¡¹ç›®å·²ç¼–è¯‘ï¼ˆ`build/` ç›®å½•å­˜åœ¨ï¼‰
- [ ] æ‰€éœ€åº“æ–‡ä»¶å­˜åœ¨ï¼ˆlibmempool.a ç­‰ï¼‰
- [ ] æ²¡æœ‰æ®‹ç•™çš„å…±äº«å†…å­˜ï¼ˆ`ls /dev/shm/zerocp_*`ï¼‰
- [ ] æœ‰è¶³å¤Ÿçš„å…±äº«å†…å­˜ç©ºé—´ï¼ˆ`df -h /dev/shm`ï¼‰

æµ‹è¯•é€šè¿‡æ ‡å‡†ï¼š

- [ ] å†™è¿›ç¨‹æˆåŠŸåˆ›å»ºå…±äº«å†…å­˜
- [ ] å†™è¿›ç¨‹å‘æ± 1/2/3å†™å…¥æ•°æ®
- [ ] è¯»è¿›ç¨‹æˆåŠŸé™„åŠ å…±äº«å†…å­˜
- [ ] è¯»è¿›ç¨‹ä»æ± 1/2/3è¯»å–æ•°æ®
- [ ] æ‰€æœ‰æ•°æ®éªŒè¯é€šè¿‡ï¼ˆé­”æ•°ã€æ± IDã€åºåˆ—å·ã€æ ¡éªŒå’Œï¼‰
- [ ] æ— å†…å­˜æ³„æ¼æˆ–æ®µé”™è¯¯
- [ ] æ¸…ç†åå…±äº«å†…å­˜è¢«æ­£ç¡®åˆ é™¤

---

**æµ‹è¯•ç‰ˆæœ¬**: v2.0  
**æœ€åæ›´æ–°**: 2025-11-02  
**ç»´æŠ¤è€…**: ZeroCP Team
